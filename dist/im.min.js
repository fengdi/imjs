"use strict";(function(a){const b={}.toString,c=a=>"[object Function]"===b.call(a),d=document,e=d.getElementsByTagName("head")[0]||d.documentElement,g=()=>d.currentScript;let h=0;const j=()=>"m-"+(++h).toString(32),k=/[^\/]+?$/,l=a=>{a=a.replace(/\\/g,"/").replace(/\/{2,}/g,"/");let b=a.split("/"),c=m(a),d="";c&&(d=b[0]?b.shift()+"//":"");for(let d=0;d<b.length;)".."===b[d]?0<d&&".."!==b[d-1]?b.splice(--d,2):c?b.splice(d,1):++d:"."===b[d]?b.splice(d,1):++d;return d+b.join("/")},m=a=>/^(?:\/|\w+:)/.test(a),n=a=>(""+a).replace(k,""),o=a=>(k.exec(""+a)||[""])[0],p=(a,b)=>{b=b||"";let c="";return k.test(a)?a=/\.js$/.test(a)?a:`${a}.js`:a+=y.default,m(a)?c=a:a[0]&&a[0]in r?c=s(a):(b=s(b),c=b?`${b}/${a}`:a),l(c)},q={},r={get"/"(){const a=window.location;return l(a.origin+n(a.pathname))},get"@"(){let a=y.cwd;return m(a)?a:l(r["/"]+(y.cwd||"./"))}},s=(a="")=>a.replace(/^[\s\S]/,b=>b in r?r[b]:b),t=(...a)=>{const[b,c,e]=a;let h,k,l;const m=g(),p=m&&m.$id,r=m&&m.$url;if(1==a.length)[h,k,l]=[p,[],b];else if(2==a.length)[h,k,l]=[p,b,c];else if(3==a.length)[h,k,l]=[b,c,e];else throw new Error("Arguments error.");return q[h]=q[h]||{id:h,uuid:j(),url:r,deps:k,factory:l,dirname:n(r),filename:o(r),time:new Date().getTime()}},u=(a,b)=>{let c=p(a,b);return new Promise((b,f)=>{const g=d.createElement("script");g.addEventListener("load",()=>{b(q[a]),e&&g&&g.parentNode&&e.removeChild(g)},{once:!0}),g.addEventListener("error",()=>{f(`Not Found Module: ${c}`)},{once:!0}),g.$id=a,g.$url=c,g.src=c+(y.tag?"?"+y.tag:""),e.insertBefore(g,e.firstChild)})},v={},w=a=>{const b=p(a);return v[b]&&t(a,[],v[b])},x=async(a,b,c=[])=>{const d=q[a]||(await u(a,b))||w(a);if(!d)throw new Error(`The module ${a} is not defined. You can define AMD module or use hook.`);const{deps:h=[],factory:e,dirname:f,filename:g}=d;return"export"in d||(d.export=await e.apply({dirname:f,filename:g},(await Promise.all(h.map(a=>x(a,f,c))))||[])),d.export},y=async(a,b)=>{a=a.trim();let d=await x(a,y.cwd);return c(b)&&b(d),d};t.amd=!0,a.define=t,a.require=y,y.modules=q,y.default="",y.cwd="",y.tag="",y.main="",y.setHook=(a,b)=>v[p(a)]=b;const z=g();if(z)try{const b=z.attributes;["cwd","tag","main","default"].forEach(c=>{let d;(d=b[`data-${c}`])&&(y[c]=d.nodeValue)})}catch(a){throw a}!window.__IM_DONOT_AUTO_RUN__&&y.main&&y(y.main)})(window);

//# sourceMappingURL=im.min.js.map