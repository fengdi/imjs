//im.js v1.3 2014-06-10T20:15:44.449Z
(function(m){function t(a,c){var b=this;b.file=a;b.pkg=0;b.state=B;b.deps=c||[];b.factory=p;b.exports=p;b._on={};b.on=function(a,c){b._on[a]=b._on[a]||[];c?b._on[a].push(c):(!isNaN(a)&&b.state<a&&(b.state=a),j(b._on[a],function(a){a.call(b)}))};b.on(q,function(){g.checkCycle(b.file)||b.loadDeps(function(){b.compile.apply(b,arguments)})})}function z(a,c){r++;var b=arguments,d=h.getPath(A()),f=[],e=u;1==b.length?e=a:(f=a,e=c);(b=g.get(d))?(b.deps=f,b.factory=e,b.on(s)):v("Can't find module:"+d,"error")}
var p=void 0,k=document,n=[],r=0,u=function(){},w=/^(\w+:\/\/\/?)(.*)/,C=/loaded|complete|undefined|interactive/,B=1,s=2,q=4,j=n.forEach?function(a,c){a.forEach(c)}:function(a,c){for(var b=0,d=a.length;b<d;b++)c(a[b],b,a)},D=n.indexOf?function(a,c){return a.indexOf(c)}:function(a,c){for(var b=0,d=a.length;b<d;b++)if(c===a[b])return b;return-1},x=function(a,c){for(var b in c)a[b]=c[b];return a},l=function(a,c){var b={}.toString,b=null===a?"null":a===p&&"undefined"||b.call(a).slice(8,-1).toLowerCase();
return c?b===c:b},v=function(a,c){if("console"in m)console[c||"log"](a)},h={normalize:function(a){var c,b="";if(c=a.match(w))b=c[1],a=c[2];if(-1===a.indexOf("."))return b+a;c=a.split("/");var d=[];j(c,function(b){if(""!=b)if(".."===b){if(0===d.length)throw Error("The path is invalid: "+a);d.pop()}else"."!==b&&d.push(b)});return b+d.join("/").replace(":80/","/")},hostRoot:function(a){var c="",b="";if(a=a.match(w))c=a[1],b=a[2].split("/")[0];return c+b+"/"},dirname:function(a){return!a.match(/\//)?
"./":a.replace(/\/[^\/]+\/?$/g,"")},isAP:function(a){return!!a.match(w)},getPath:function(a){if(!h.isAP(a)){var c=(location.href+"").replace(/(\?|#).*$/i,""),c=a.match(/^\/|\\/g)?h.hostRoot(c):h.dirname(c.match(/\/|\\$/g)?c+"i":c);a=c+"/"+a}return a}},A=function(){if(k.currentScript)return k.currentScript.src;for(var a=k.scripts||k.getElementsByTagName("script"),c=a.length-1;-1<c;c--)if(/interactive/.test(a[c].readyState))return a[c].src;var b;try{arguments.length()}catch(d){b=d.stack||m.opera&&((d+
"").match(/of linked script \S+/g)||[]).join(" ")}b=b.split(/[@ ]/g).pop();b=b.replace(/^\(/,"").replace(/\)$/,"");return b.replace(/(:\d+)?:\d+(\s)?$/i,"")},n=h.getPath(A()),y={path:n,tag:"?t="+ +new Date};x(t.prototype,{load:function(){var a=this,c=r,b=k.getElementsByTagName("head")[0]||k.documentElement,d=k.createElement("script");d.type="text/javascript";d.async="async";d.src=a.file;d.onerror=function(){g.remove(a.file)};d.onload=d.onreadystatechange=function(){if(C.test(d.readyState)&&(a.on(3),
d&&(d.onerror=d.onload=d.onreadystatechange=null),b&&d&&d.parentNode&&b.removeChild(d),d=p,r===c)){r++;var f=g.get(a.file);f&&(f.deps=[],f.factory=function(){},f.on(s))}};b.insertBefore(d,b.firstChild)},compile:function(){var a=this.factory;this.exports=l(a,"function")?a.apply({},arguments):a;this.state=5;this.on(5)},loadDeps:function(a){g.load(this.deps,a)}});var g={data:{},set:function(a,c){this.data[a]=c},get:function(a){return this.data[a]},remove:function(a){delete this.data[a]},checkCycle:function(a,
c){var b,d,f=!1;b=this.data[a];c=c||[];if(b){b=l(b.deps,"array")?b.deps:[b.deps];for(b=this.realpaths(b);d=b.shift();)if(-1==D(c,d))if(c.push(d),f=this.checkCycle(d,c))break;else c.pop();else return c.push(d),v("Circular dependencies:\r\n"+c.join(" >>\r\n"),"error"),!0}return f},exports:function(a){var c=this,b=[];j(a,function(a){a=c.get(a);b.push(a&&a.exports)});return b},isOk:function(a){var c=this,b=1;j(a,function(a){a=c.data[a];if(!a||5>a.state)b=0});return b},realpaths:function(a){var c=[];l(a,
"array")||(a=[a]);j(a,function(a){a=(a||"").replace(/^(\s|\u00A0)+|(\s|\u00A0)+$/g,"");h.isAP(a)||(a=h.normalize(h.dirname(y.path)+"/"+a));/\.js$/.test(a)||(a+=".js");a+=y.tag||"";c.push(a)});return c},load:function(a,c){var b=this,d=!1;a=b.realpaths(a);0==a.length?c():j(a,function(f){var e=b.get(f);if(e){if(e.pkg&&e.state<q)e.on(q)}else e=new t(f),e.on(s,function(){e.on(q)}),setTimeout(function(){e.load()},1),b.set(f,e);if(5>e.state)e.on(5,function(){b.isOk(a)&&c.apply(m,b.exports(a))});else b.isOk(a)&&
!d&&(d=!0,c.apply(m,b.exports(a)))})}};z.tmd=!0;x(m,{define:z,require:function(a,c){if(1<arguments.length)g.load(a||[],function(){(c||u).apply(this,arguments)});else if(l(a,"array")||l(a,"string"))g.load(a,u);else if(l(a,"function"))return a()},defines:function(a){j(a,function(a){var b=g.realpaths(a.uri)[0],d=new t(b,a.deps);g.set(b,d);d.factory=a.factory;d.pkg=1;d.on(s)})},Im:{modules:g.data,im:"1.3",log:v,imPath:n,config:function(a){return x(y,a||{})}}})})(this);
